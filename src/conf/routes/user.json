{
	"/users": {
		"module"        : "db_crud",
		"method"        : "read",
		"authorisation" : "admin",
		"params"		: {
			"model"   			: "user",
			"query"  			: { "$nor" : [ { "roles":"superAdmin" }, { "roles":"admin"} ] },
			"fields" 			: ["user_name", "first_name","last_name","email","phone_number","company_id"]
		},
		"subroutes" : {
			"/create" : {
				"req_method"	: "post",
				"module"    	: "db_crud",
				"method"		: "create",
				"authorisation" : "admin",
				"params" 		: {
					"audit_log_message" : "Added new user as an end user",
					"model"       		: "user",
					"before" 			: [ "users.validateTwoPasswords","users.checkForDuplicateUserWhileCreating","users.md5Password", "users.setDefaultRoles"],
					"validation" 		: {
						"user_name" : { 
							"required" : {
								"error_message" : "Please enter Username."
							},
							"length": {
								"error_message" : "Please enter Username,allowed length is in the range of 5-20.",
								"min"			: 5,
								"max"			: 20
							}
						},
						"password"         : { 
							"required" : {
								"error_message" : "Please enter Password."
							},
							"length": {
								"error_message" : "Please enter Password,allowed length is in the range of 5-20.",
								"min"			: 5,
								"max"			: 20
							}
						},
						"email"            : { 
							"required" : {
								"error_message" : "Please enter Email."
							},
							"email": {
								"error_message" : "Please enter valid email id."
							}
						}, 
						"confirm_password" : {
						 	"required": {
								"error_message" : "Please enter Password."
							},
							"length": {
								"error_message" : "Please enter Password,allowed length is in the range of 5-20.",
								"min"			: 5,
								"max"			: 20
							}
						},
						"phone_number" : { 
							"required" : {
								"error_message" : "Please enter Phone Number."
							}
						},
						"first_name" : { 
							"required"  : {
								"error_message" : "Please enter First name"
							},
							"length": {
								"error_message" : "Please enter First name,allowed length is in the range of 5-20.",
								"min"			: 5,
								"max"			: 20
							}
						},
						"last_name" : { 
							"required": {
								"error_message" : "Please enter Last name."
							},
							"length": {
								"error_message" : "Please enter Last name,allowed length is in the range of 5-20.",
								"min"			: 5,
								"max"			: 20
							}
						},
						"company_id" : { 
							"required": {
								"error_message" : "Please enter Company id"
							}
						}
					}
				}
			},
			"/update/:id" :{
				"req_method"	: "post",
				"module"    	: "db_crud",
				"method"		: "update",
				"authorisation" : "admin",
				"params"		:{
					"audit_log_message" : "edited user details",
					"model"       		: "user",
					"before" 			: [ "users.validateTwoPasswords", "users.checkForDuplicateUserWhileUpdating" , "users.md5Password", "users.setDefaultRoles"],
					"query" 			: { "_id" : "${id}" },
					"validation" 		: {
						"user_name" : { 
							"required": {
								"error_message" : "Please enter Username."
							},
							"length" : {
								"error_message" : "Please enter Username,allowed length is in the range of 5-20.",
								"min"			: 5,
								"max"			: 20
							}
						},
						"password" : { 
							"required" : {
								"error_message" : "Please enter Password."
							},
							"length": {
								"error_message" : "Please enter Password,allowed length is in the range of 5-20.",
								"min"			: 5,
								"max"			: 20
							}
						},
						"email" : { 
							"required" : {
								"error_message" : "Please enter Email."
							},
							"email" : {
								"error_message" : "Please enter valid email id."
							}
						}, 
						"confirm_password" : {
						 	"required" : {
								"error_message" : "Please enter Password."
							},
							"length": {
								"error_message" : "Please enter Password,allowed length is in the range of 5-20.",
								"min"			: 5,
								"max"			: 20
							}
						},
						"phone_number" : { 
							"required" : {
								"error_message" : "Please enter Phone Number."
							}
						},
						"first_name" : { 
							"required" : {
								"error_message" : "Please enter First name"
							},
							"length": {
								"error_message" : "Please enter First name,allowed length is in the range of 5-20.",
								"min"			: 5,
								"max"			: 20
							}
						},
						"last_name" : { 
							"required" : {
								"error_message" : "Please enter Last name."
							},
							"length": {
								"error_message" : "Please enter Last name,allowed length is in the range of 5-20.",
								"min"			: 5,
								"max"			: 20
							}
						},
						"company_id" : { 
							"required" : {
								"error_message" : "Please enter Company id."
							}
						}
					}
				}
			},
			"/update-by-user" : {
				"module" 		: "db_crud",
				"authorisation"	:"user",
				"subroutes" 	: {
					"/email" : {
						"req_method"	: "post",
						"module"    	: "db_crud",
						"method"		: "update",
						"authorisation" : "user",
						"params"		: {
							"audit_log_message" : "user updated his email id",
							"model"       		: "user",
							"before" 			: [ "users.getCurrentUID", "users.validateTwoEmails"],
							"query"  			: {"_id":"${currentUID}"},
							"validation" 		: {
								"email" : { 
									"required" : {
										"error_message" : "Please enter Email."
									},
									"email": {
										"error_message" : "Please enter valid email id."
									}
								},
								"confirm_email" : {
									"required": {
										"error_message" : "Please enter Email."
									},
									"email": {
										"error_message" : "Please enter valid email id."
									}
								}
							}
						}
					},
					"/password":{
						"req_method"	: "post",
						"module"    	: "db_crud",
						"method"		: "update",
						"authorisation" : "user",
						"params"		:{
							"audit_log_message" : "user updated his password",
							"model"       		: "user",
							"before" 			: [ "users.validateCurrentPassword", "users.getCurrentUID",  "users.validateTwoPasswords","users.md5Password"],
							"query"  			: {"_id": "${currentUID}"},
							"validation" 		: {
								"current_password" : { "length": { "min":5, "max":20 } },
								"password"         : { "length": { "min":5, "max":20 } },
								"confirm_password" : { "length": { "min":5, "max":20 } }
							}
						}
					}
				}
			},
			"/delete/:id" :{
				"req_method"	: "get",
				"module"    	: "db_crud",
				"method"		: "delete",
				"authorisation" : "admin",
				"params"		: {
					"audit_log_message" : "End user deleted",
					"model"   			: "user",
					"before" 			: [ "users.isUserNotAdmin" ],
					"query"  			: { "_id" : "${id}" }
				}
			},
			"/:id" :{
				"req_method"	: "get",
				"module"    	: "db_crud",
				"method"		: "read",
				"authorisation" : "user",
				"params"		: {
					"model"   			: "user",
					"query"  			: { "_id" : "${id}" },
					"fields" 			: ["user_name", "first_name","last_name","email","phone_number"]
				}
			},
			"/for-customer/:id" :{
				"req_method"	: "get",
				"module"    	: "db_crud",
				"method"		: "read",
				"authorisation" : "admin",
				"params"		: {
					"model"   			: "user",
					"query"  			: { "company_id" : "${id}" },
					"fields" 			: ["user_name", "first_name","last_name","email","phone_number"]
				}
			}
		}
	}
}